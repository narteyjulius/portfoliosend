




{% extends "admin/base_site.html" %}
{% load static %}

{% block content %}

<style>
    .charts-wrapper {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
    }
    .chart-box {
        flex: 1;
        min-width: 300px;
        max-width: 500px;
        background: #fff;
        padding: 15px;
        border-radius: 8px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    canvas {
        width: 100% !important;
        height: 300px !important; /* keep charts small */
    }
</style>

<h1>CV Downloads Dashboard</h1>

<div class="charts-wrapper">

    <div class="chart-box">
        <h2>Downloads Over Time</h2>
        <canvas id="downloadsChart"></canvas>
    </div>

    <div class="chart-box">
        <h2>Downloads by Browser</h2>
        <canvas id="browserChart"></canvas>
    </div>

    <div class="chart-box">
        <h2>Downloads by OS</h2>
        <canvas id="osChart"></canvas>
    </div>

</div>
<!-- 
<h2>Downloads Over Time</h2>
<div style="max-width:600px; margin-bottom:30px;">
    <canvas id="downloadsChart"></canvas>
</div>

<h2>Downloads by Browser</h2>
<div style="max-width:400px; margin-bottom:30px;">
    <canvas id="browserChart"></canvas>
</div>

<h2>Downloads by OS</h2>
<div style="max-width:400px; margin-bottom:30px;">
    <canvas id="osChart"></canvas>
</div> -->

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  // Timeline chart (small)
  const ctxDay = document.getElementById('downloadsChart').getContext('2d');
  new Chart(ctxDay, {
      type: 'line',
      data: {
          labels: {{ labels_day|safe }},
          datasets: [{
              label: 'CV Downloads per Day',
              data: {{ data_day|safe }},
              fill: true,
              borderColor: 'rgb(75, 192, 192)',
              backgroundColor: 'rgba(75, 192, 192, 0.2)',
              tension: 0.3
          }]
      },
      options: { 
          responsive: true, 
          maintainAspectRatio: false,
          scales: { y: { beginAtZero: true } }
      }
  });

  // Browser chart (small)
  const ctxBrowser = document.getElementById('browserChart').getContext('2d');
  new Chart(ctxBrowser, {
      type: 'pie',
      data: {
          labels: {{ labels_browser|safe }},
          datasets: [{
              data: {{ data_browser|safe }},
              backgroundColor: [
                  '#36A2EB','#FF6384','#FFCE56','#4BC0C0','#9966FF','#FF9F40'
              ]
          }]
      },
      options: { responsive: true, maintainAspectRatio: false }
  });

  // OS chart (small)
  const ctxOS = document.getElementById('osChart').getContext('2d');
  new Chart(ctxOS, {
      type: 'pie',
      data: {
          labels: {{ labels_os|safe }},
          datasets: [{
              data: {{ data_os|safe }},
              backgroundColor: [
                  '#FF6384','#36A2EB','#FFCE56','#4BC0C0','#9966FF','#FF9F40'
              ]
          }]
      },
      options: { responsive: true, maintainAspectRatio: false }
  });
</script>
{{ block.super }}

{% endblock %}